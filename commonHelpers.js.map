{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["// Import Axios\nimport axios from \"axios\";\n\n// Strict mode\n'use strict'\n\nexport async function fetchImages(searchCriteria, pageNum, perPage) {\n \n    const searchParams = new URLSearchParams({\n        key: \"43557588-360f3c0dbe3221038cf66573a\",\n        q: searchCriteria,\n        image_type: \"photo\",\n        orientation: \"horizontal\", \n        safesearch: true, \n        page: pageNum,\n        per_page: perPage\n    });\n    \n    const url = `https://pixabay.com/api/?${searchParams}`;\n\n    // Return fetch(url);\n    return await axios.get(url);\n };","// Import the SimpleLightbox library\nimport SimpleLightbox from \"simplelightbox\";\n// Additional import of SimpleLightbox style\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n// Strict mode\n'use strict'\n\nconst lightbox = new SimpleLightbox(\".gallery a\", {                // the simpleLightbox pattern\n        captions: true,                                            // show captions if availabled or not\n        captionSelector: 'img',                                    // set the element where the caption is\n        captionsData: 'alt',                                       // get the caption from given attribute\n        captionPosition: 'bottom',                                        \n        captionDelay: 250,                                         // delay before the caption shows (in ms)\n        captionType: 'attr'                                        // how to get the caption.                                                                  // You can choose between attr, data or text\n    });\n\nexport function renderImagesByPages(dataHit) { \n    \n    let gallery = document.querySelector(\"ul.gallery-ul\");\n\n    const markup = dataHit\n            .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n                `    <li class=\"gallery-item\">\n                        <div class=\"gallery\">\n                            <a class=\"gallery-link\" href=\"${largeImageURL}\" >\n                                <img class=\"gallery-image\" src=\"${webformatURL}\" data-source=\"${largeImageURL}\" alt=\"${tags}\" />\n                            </a>\n                        </div>    \n                        <div class=\"gallery-props\">\n                            <div class=\"gallery-props-item\">\n                                Likes\n                                    <div class=\"gallery-props-number\">${likes}</div>\n                            </div>\n                            <div class=\"gallery-props-item\">\n                                Views\n                                    <div class=\"gallery-props-number\">${views}</div>\n                            </div>\n                            <div class=\"gallery-props-item\">\n                                Comments\n                                    <div class=\"gallery-props-number\">${comments}</div>\n                            </div>\n                            <div class=\"gallery-props-item\">\n                                Downloads\n                                    <div class=\"gallery-props-number\">${downloads}</div>\n                            </div>\n                        </div>\n                    </li>`\n            )\n            .join(\"\");\n    // Display the gallery    \n    gallery.insertAdjacentHTML(\"beforeend\", markup); \n    lightbox.refresh();\n}","//  Main import of iziToast\nimport iziToast from \"izitoast\";\n// Additional import of iziToast style\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { fetchImages } from \"./js/pixabay-api.js\";\nimport { renderImagesByPages } from \"./js/render-functions.js\";\n\n// Strict mode\n'use strict'\n\n// Query selectors\nconst searchFld = document.querySelector(\".search-block-field\");\nconst searchBtn = document.querySelector(\".search-block-button\"); \nconst loadMoreBtn = document.querySelector(\".load-more-button\");\nconst loader = document.querySelector(\".loader\");\nconst loaderMore = document.querySelector(\".load-more-loader\");\nlet gallery = document.querySelector(\"ul.gallery-ul\");\nlet searchEnd = document.querySelector(\".load-more-search-end\");\n\n// Define global variables\nlet searchCriteria = '';\nlet searchCriteriaLoad = '';\nlet perPage = 15;\nlet pageNum;\nlet totalPages;\nlet scrollHeight; \n\nhideElement(loadMoreBtn);                               // Hide Load More button\nhideElement(searchEnd);\n\n// Add listeners\nsearchFld.addEventListener(\"input\", () => { \n    searchCriteria = searchFld.value;\n});\nsearchBtn.addEventListener(\"click\", searchImages);\nloadMoreBtn.addEventListener(\"click\", loadImagesMore);\n\nasync function searchImages() { \n    pageNum = 1;\n    gallery.innerHTML = \"\";                             // Clear gallery content to avoid mixing query results\n    showElement(loader);                                // Display progress bar\n    hideElement(loadMoreBtn);                           // Hide Load More button\n\n    await performSearch();\n};\n\nasync function loadImagesMore() { \n    pageNum += 1;\n    showElement(loaderMore);                            // Display progress bar\n    hideElement(loadMoreBtn);                           // Hide Load More button\n\n    await loadNextPage();\n};\n\n//========================== performSearch() ===========================//\nasync function performSearch() { \n\n    if (!searchCriteria.trim()) {                       // Search field cannot be empty\n        hideElement(searchEnd);                         // Hide message about search results end\n        iziToastError('Search field cannot be empty');\n        hideElement(loader);                            // Hide progress bar\n        return;   \n    }\n    \n    searchCriteriaLoad = searchCriteria;\n    hideElement(searchEnd);                             // Hide message about search results end\n\n    try {\n        const data = await fetchAndRenderImages(searchCriteria, pageNum);\n        handleSearchResults(data);\n    } catch (error) { \n        console.log(error);\n        iziToastError('Sorry, an error occurred. Please, check your connection or try again later.');\n    };\n\n    hideElement(loader);                            // Hide progress bar\n    searchFld.value = '';                           // Clear Search field\n\n    // Define height of a <li> element for scrollDown();\n    const liItem = document.querySelector(\"li.gallery-item:first-child\");\n    if (liItem){\n        scrollHeight = Math.ceil(liItem.getBoundingClientRect().height * 2);\n    };\n};\n\n//========================== loadNextPage() ===========================//\nasync function loadNextPage() {\n\n    hideElement(searchEnd);                         // Hide message about search results end\n    try {\n        const data = await fetchAndRenderImages(searchCriteriaLoad, pageNum);\n        handleSearchResults(data);\n\n    } catch(error) { \n        console.log(error);\n        iziToastError('Sorry, an error occurred. Please, check your connection or try again later.');\n    };\n\n    hideElement(loaderMore);                        // Hide progress bar\n  };\n\n //========================== fetchAndRenderImages() ===========================//\nasync function fetchAndRenderImages(criteria, page) { \n    const response = await fetchImages(criteria, page, perPage);\n    const data = await response.data;\n    return data;\n};\n\n//========================== handleSearchResults() ===========================//\nfunction handleSearchResults(data) {\n\n    if (data.total === 0) {                         // Check if the total number of items is 0\n        iziToastError('Sorry, there are no images matching your search query. Please try again!');\n        hideElement(loader);                        // Hide progress bar\n        searchCriteria = '';\n        return;\n    }\n\n    renderImagesByPages(data.hits.flat());          // Return data.hits;\n                    \n    hideElement(loader);                            // Hide progress bar\n    searchCriteria = '';    \n\n    totalPages = Math.ceil(data.total / perPage);\n    console.log(\"handleSearchResults() >> pageNum: \", pageNum, \"totalPages: \", totalPages);\n    \n    scrollDown();                                   // Smooth scroll down\n\n    if (pageNum < totalPages) {\n        showElement(loadMoreBtn);                   // Show Load More button\n    }\n    else { \n        hideElement(loadMoreBtn);\n        showElement(searchEnd);\n    };\n    // pageNum < totalPages ?\n    //     (showElement(loadMoreBtn)\n    // ) : (\n    //      iziToastInfo(\"We're sorry, but you've reached the end of search results.\"   \n    // ));\n };\n\n //========================== hideElement() ===========================//\nfunction hideElement(element) { \n    element.style.display = 'none';\n};\n\n //========================== showElement() ===========================//\nfunction showElement(element) { \n    element.style.display = 'block';\n};\n\n //========================== iziToastError() ===========================//\nfunction iziToastError(msg) { \n    iziToast.error({\n        title: 'Error',\n        message: msg\n    });\n};\n\n//========================== iziToastInfo() ===========================//\nfunction iziToastInfo(msg) { \n    iziToast.info({\n        title: 'Info',\n        message: msg\n    });\n};\n\n //========================== scrollDown() ===========================//\nfunction scrollDown() { \n    window.scrollBy({\n        top: scrollHeight, \n        left: 0,  \n        behavior: 'smooth' \n    });\n};\n"],"names":["fetchImages","searchCriteria","pageNum","perPage","url","axios","lightbox","SimpleLightbox","renderImagesByPages","dataHit","gallery","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","searchFld","searchBtn","loadMoreBtn","loader","loaderMore","searchEnd","searchCriteriaLoad","totalPages","scrollHeight","hideElement","searchImages","loadImagesMore","showElement","performSearch","loadNextPage","iziToastError","data","fetchAndRenderImages","handleSearchResults","error","liItem","criteria","page","scrollDown","element","msg","iziToast"],"mappings":"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"}